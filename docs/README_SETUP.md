# Distributed LLM Inference System

## Quick Start

### 1. Install Dependencies
```bash
pip install -r requirements.txt
```

### 2. Validate Setup
```bash
python setup_validator.py --validate-all
```

### 3. Start Server
```bash
python start_server.py --node-id physical_node_1 --config network_config.json
```

### 4. Start Chatbot Client
```bash
python chatbot_interface.py --tokenizer-path assets/models/llama3_1_8b_fp16/blocks/tokenizer
```

## Project Structure
- `model_node.py` - Main inference server
- `config_manager.py` - Configuration management
- `worker_lib.py` - CPU/GPU workers
- `chatbot_interface.py` - Chat client
- `assets/models/` - Model files
- `logs/` - Log files
- `sessions/` - Session data

## Configuration
- Network config: `network_config.json`
- Model metadata: `assets/models/llama3_1_8b_fp16/metadata.json`
- Portable config: `portable_config.json`

## Troubleshooting
1. Run validator: `python setup_validator.py --validate-all --fix`
2. Check logs in `logs/` directory
3. Verify model files in `assets/models/`

Generated by setup_validator.py on D:\Tiktrue\Tiktrue_Platform

## 📊 پروفایل سیستم (System Profiling)

### چرا پروفایل سیستم مهم است؟

پروفایل سیستم **ضروری** است چون:
- 🎯 عملکرد سیستم شما رو روی هر مدل تست می‌کنه
- 📄 فایل `performance_profile.json` رو تولید می‌کنه
- 🧠 Scheduler از این فایل برای تقسیم بهینه CPU/GPU استفاده می‌کنه
- ⚡ مدل‌های بهینه‌سازی شده رو می‌سازه

### نحوه استفاده:

```bash
# پروفایل کامل سیستم (توصیه می‌شود)
python start_server.py --profile-system

# پروفایل با مدل خاص
python start_server.py --profile-system --model llama3_1_8b_fp16

# پروفایل مستقل
python static_profiler.py --network-config network_config.json

# فقط بهینه‌سازی مدل‌ها
python static_profiler.py --network-config network_config.json --optimize-only

# فقط تست عملکرد
python static_profiler.py --network-config network_config.json --profile-only
```

### خروجی پروفایل:

```
📊 PROFILING SUMMARY
============================================================

🔹 BLOCK_1:
   CPU                 :   45.2ms
   Dml                 :   23.1ms

🔹 BLOCK_2:
   CPU                 :   42.8ms
   Dml                 :   25.3ms

...

📊 TOTAL: 64/66 successful runs across 33 blocks
💾 Results saved to: performance_profile.json
```

### فایل performance_profile.json:

این فایل شامل:
- زمان اجرای هر بلاک روی CPU و GPU
- آمار کامل (میانگین، حداقل، حداکثر)
- اطلاعات سیستم و تنظیمات
- نتایج برای scheduler

**نکته**: اولین بار که سیستم رو راه‌اندازی می‌کنید، حتماً پروفایل رو اجرا کنید!